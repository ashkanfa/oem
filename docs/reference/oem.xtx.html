<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Orthogonalizing EM — oem.xtx â€¢ oem</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">oem</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/oem_vignette.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jaredhuling/oem">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Orthogonalizing EM</h1>
    </div>

    
    <p>Orthogonalizing EM</p>
    

    <pre class="usage"><span class='fu'>oem.xtx</span>(<span class='no'>xtx</span>, <span class='no'>xty</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"gaussian"</span>, <span class='st'>"binomial"</span>),
  <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"elastic.net"</span>, <span class='st'>"lasso"</span>, <span class='st'>"ols"</span>, <span class='st'>"mcp"</span>, <span class='st'>"scad"</span>, <span class='st'>"mcp.net"</span>,
  <span class='st'>"scad.net"</span>, <span class='st'>"grp.lasso"</span>, <span class='st'>"grp.lasso.net"</span>, <span class='st'>"grp.mcp"</span>, <span class='st'>"grp.scad"</span>,
  <span class='st'>"grp.mcp.net"</span>, <span class='st'>"grp.scad.net"</span>, <span class='st'>"sparse.grp.lasso"</span>), <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fu'>numeric</span>(<span class='fl'>0</span>),
  <span class='kw'>nlambda</span> <span class='kw'>=</span> <span class='fl'>100L</span>, <span class='kw'>lambda.min.ratio</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>gamma</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>tau</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'>numeric</span>(<span class='fl'>0</span>), <span class='kw'>scale.factor</span> <span class='kw'>=</span> <span class='fu'>numeric</span>(<span class='fl'>0</span>),
  <span class='kw'>penalty.factor</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>group.weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>500L</span>,
  <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-07</span>, <span class='kw'>irls.maxit</span> <span class='kw'>=</span> <span class='fl'>100L</span>, <span class='kw'>irls.tol</span> <span class='kw'>=</span> <span class='fl'>0.001</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>xtx</th>
      <td><p>input matrix equal to <code>crossprod(x) / nrow(x)</code>. 
where <code>x</code> is the design matrix.
It is highly recommended to scale by the number of rows in <code>x</code>.
If <code>xtx</code> is scaled, <code>xty</code> must also be scaled or else results may be meaningless!</p></td>
    </tr>
    <tr>
      <th>xty</th>
      <td><p>numeric vector of length <code>nvars</code>. Equal to <code>crosprod(x, y) / nobs</code>. 
It is highly recommended to scale by the number of rows in <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p><code>"gaussian"</code> for least squares problems, <code>"binomial"</code> for binary response. 
(only <code>gaussian</code> implemented currently)</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p>Specification of penalty type. Choices include:</p><ul>
<li><p><code>"elastic.net"</code> - elastic net penalty, extra parameters: <code>"alpha"</code></p></li>
<li><p><code>"lasso"</code> - lasso penalty</p></li>
<li><p><code>"ols"</code> - ordinary least squares</p></li>
<li><p><code>"mcp"</code> - minimax concave penalty, extra parameters: <code>"gamma"</code></p></li>
<li><p><code>"scad"</code> - smoothly clipped absolute deviation, extra parameters: <code>"gamma"</code></p></li>
<li><p><code>"mcp.net"</code> - minimax concave penalty + l2 penalty, extra parameters: 
   <code>"gamma"</code>, <code>"alpha"</code></p></li>
<li><p><code>"scad.net"</code> - smoothly clipped absolute deviation + l2 penalty, extra parameters: 
   <code>"gamma"</code>, <code>"alpha"</code></p></li>
<li><p><code>"grp.lasso"</code> - group lasso penalty</p></li>
<li><p><code>"grp.lasso.net"</code> - group lasso penalty + l2 penalty, extra parameters: <code>"alpha"</code></p></li>
<li><p><code>"grp.mcp"</code> - group minimax concave penalty, extra parameters: <code>"gamma"</code></p></li>
<li><p><code>"grp.scad"</code> - group smoothly clipped absolute deviation, extra parameters: <code>"gamma"</code></p></li>
<li><p><code>"grp.mcp.net"</code> - group minimax concave penalty + l2 penalty, extra parameters: <code>"gamma"</code>, <code>"alpha"</code></p></li>
<li><p><code>"grp.scad.net"</code> - group smoothly clipped absolute deviation + l2 penalty, extra parameters: <code>"gamma"</code>, <code>"alpha"</code></p></li>
<li><p><code>"sparse.grp.lasso"</code> - sparse group lasso penalty (group lasso + lasso), extra parameters: <code>"tau"</code></p></li>
</ul><p>Careful consideration is required for the group lasso, group MCP, and group SCAD penalties. Groups as specified by the <code>groups</code> argument 
should be chosen in a sensible manner.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>A user supplied lambda sequence. By default, the program computes
its own lambda sequence based on <code>nlambda</code> and <code>lambda.min.ratio</code>. Supplying
a value of lambda overrides this.</p></td>
    </tr>
    <tr>
      <th>nlambda</th>
      <td><p>The number of lambda values - default is 100.</p></td>
    </tr>
    <tr>
      <th>lambda.min.ratio</th>
      <td><p>Smallest value for lambda, as a fraction of <code>lambda.max</code>, the (data derived) entry
value (i.e. the smallest value for which all coefficients are zero). The default
depends on the sample size nobs relative to the number of variables nvars. The default is 0.0001</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>mixing value for <code>elastic.net</code>, <code>mcp.net</code>, <code>scad.net</code>, <code>grp.mcp.net</code>, <code>grp.scad.net</code>. 
penalty applied is (1 - alpha) * (ridge penalty) + alpha * (lasso/mcp/mcp/grp.lasso penalty)</p></td>
    </tr>
    <tr>
      <th>gamma</th>
      <td><p>tuning parameter for SCAD and MCP penalties. must be &gt;= 1</p></td>
    </tr>
    <tr>
      <th>tau</th>
      <td><p>mixing value for <code>sparse.grp.lasso</code>. penalty applied is (1 - tau) * (group lasso penalty) + tau * (lasso penalty)</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>A vector of describing the grouping of the coefficients. See the example below. All unpenalized variables
should be put in group 0</p></td>
    </tr>
    <tr>
      <th>scale.factor</th>
      <td><p>of length <code>nvars === ncol(xtx) == length(xty)</code> for scaling columns of <code>x</code>. The standard deviation
for each column of <code>x</code> is a common choice for <code>scale.factor</code>. Coefficients will be returned on original scale. Default is 
no scaling.</p></td>
    </tr>
    <tr>
      <th>penalty.factor</th>
      <td><p>Separate penalty factors can be applied to each coefficient. 
This is a number that multiplies lambda to allow differential shrinkage. Can be 0 for some variables, 
which implies no shrinkage, and that variable is always included in the model. Default is 1 for all 
variables.</p></td>
    </tr>
    <tr>
      <th>group.weights</th>
      <td><p>penalty factors applied to each group for the group lasso. Similar to <code>penalty.factor</code>, 
this is a number that multiplies lambda to allow differential shrinkage. Can be 0 for some groups, 
which implies no shrinkage, and that group is always included in the model. Default is sqrt(group size) for all
groups.</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>integer. Maximum number of OEM iterations</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>convergence tolerance for OEM iterations</p></td>
    </tr>
    <tr>
      <th>irls.maxit</th>
      <td><p>integer. Maximum number of IRLS iterations</p></td>
    </tr>
    <tr>
      <th>irls.tol</th>
      <td><p>convergence tolerance for IRLS iterations. Only used if <code>family != "gaussian"</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object with S3 class <code>"oem"</code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>set.seed</span>(<span class='fl'>123</span>)
<span class='no'>n.obs</span> <span class='kw'>&lt;-</span> <span class='fl'>1e4</span>
<span class='no'>n.vars</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>

<span class='no'>true.beta</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fu'>runif</span>(<span class='fl'>15</span>, -<span class='fl'>0.25</span>, <span class='fl'>0.25</span>), <span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='no'>n.vars</span> - <span class='fl'>15</span>))

<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>n.obs</span> * <span class='no'>n.vars</span>), <span class='no'>n.obs</span>, <span class='no'>n.vars</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='no'>n.obs</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>3</span>) + <span class='no'>x</span> <span class='kw'>%*%</span> <span class='no'>true.beta</span>

<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='oem.html'>oem</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>x</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>y</span>,
           <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"lasso"</span>, <span class='st'>"elastic.net"</span>,
                        <span class='st'>"ols"</span>,
                        <span class='st'>"mcp"</span>,       <span class='st'>"scad"</span>,
                        <span class='st'>"mcp.net"</span>,   <span class='st'>"scad.net"</span>,
                        <span class='st'>"grp.lasso"</span>, <span class='st'>"grp.lasso.net"</span>,
                        <span class='st'>"grp.mcp"</span>,   <span class='st'>"grp.scad"</span>,
                        <span class='st'>"sparse.grp.lasso"</span>),
           <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
           <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span>:<span class='fl'>20</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>5</span>))

<span class='no'>xtx</span> <span class='kw'>&lt;-</span> <span class='fu'>crossprod</span>(<span class='no'>x</span>) / <span class='no'>n.obs</span>
<span class='no'>xty</span> <span class='kw'>&lt;-</span> <span class='fu'>crossprod</span>(<span class='no'>x</span>, <span class='no'>y</span>) / <span class='no'>n.obs</span>

<span class='no'>fit.xtx</span> <span class='kw'>&lt;-</span> <span class='fu'>oem.xtx</span>(<span class='kw'>xtx</span> <span class='kw'>=</span> <span class='no'>xtx</span>, <span class='kw'>xty</span> <span class='kw'>=</span> <span class='no'>xty</span>,
                   <span class='kw'>penalty</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"lasso"</span>, <span class='st'>"elastic.net"</span>,
                               <span class='st'>"ols"</span>,
                               <span class='st'>"mcp"</span>,       <span class='st'>"scad"</span>,
                               <span class='st'>"mcp.net"</span>,   <span class='st'>"scad.net"</span>,
                               <span class='st'>"grp.lasso"</span>, <span class='st'>"grp.lasso.net"</span>,
                               <span class='st'>"grp.mcp"</span>,   <span class='st'>"grp.scad"</span>,
                               <span class='st'>"sparse.grp.lasso"</span>),
                   <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span>:<span class='fl'>20</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>5</span>))

<span class='fu'>max</span>(<span class='fu'>abs</span>(<span class='no'>fit</span>$<span class='no'>beta</span><span class='kw'>[[</span><span class='fl'>1</span>]][-<span class='fl'>1</span>,] - <span class='no'>fit.xtx</span>$<span class='no'>beta</span><span class='kw'>[[</span><span class='fl'>1</span>]]))</div><div class='output co'>#&gt; [1] 8.788644e-16</div><div class='input'><span class='fu'>max</span>(<span class='fu'>abs</span>(<span class='no'>fit</span>$<span class='no'>beta</span><span class='kw'>[[</span><span class='fl'>2</span>]][-<span class='fl'>1</span>,] - <span class='no'>fit.xtx</span>$<span class='no'>beta</span><span class='kw'>[[</span><span class='fl'>2</span>]]))</div><div class='output co'>#&gt; [1] 8.788644e-16</div><div class='input'>
<span class='fu'>layout</span>(<span class='fu'>matrix</span>(<span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>2</span>))
<span class='fu'>plot</span>(<span class='no'>fit.xtx</span>)
<span class='fu'>plot</span>(<span class='no'>fit.xtx</span>, <span class='kw'>which.model</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><img src='oem.xtx-6.png' alt='' width='540' height='400' /><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Bin Dai, Jared Huling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
